FROM ubuntu:20.04

# prevent failures due to interactive apt transactions
ENV DEBIAN_FRONTEND=noninteractive

RUN apt-get -y update
RUN apt-get -y upgrade --no-install-recommends
RUN apg-get -y -f install

RUN apt-get -y install gcc g++ autoconf automake libtool libxml2-dev \
                       libprotobuf-dev python3-protobuf uuid-dev debhelper pkg-config \
                       protobuf-compiler git dh-python python3-zmq \
                       python3-dev libzmq5 libzmq3-dev sqlite3 libsqlite3-dev python3-lxml \
                       python3-setuptools

WORKDIR /opt
RUN git clone https://github.com/adjacentlink/opentestpoint -b develop

WORKDIR opentestpoint
RUN ./autogen.sh
RUN ./configure
RUN make deb
RUN dpkg -i $(find .debbuild -name "*\.deb") && apt-get -y -f install

RUN echo 'ubuntu20.04 complete'

